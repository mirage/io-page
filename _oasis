OASISFormat: 0.3
Name:        io-page
Version:     1.0.0
Synopsis:    Page-aligned memory allocator
Authors:     Anil Madhavapeddy, David Scott, Thomas Gazagnaire
License:     ISC
Plugins:     META (0.3), DevFiles (0.3)
BuildTools:  ocamlbuild

Flag unix
  Description:        build the unix library
  Default:            true

Library "io-page"
  CompiledObject:     best
  Path:               lib
  Findlibname:        io-page
  Modules:            Io_page
  BuildDepends:       cstruct, mirage-types

Library "io-page-unix"
  Build$:             flag(unix)
  CompiledObject:     best
  Path:               lib
  FindlibParent:      io-page
  Findlibname:        unix
  Modules:            Io_page_unix # Dummy module to compile the library
  BuildDepends:       io-page
  CSources:           stub_alloc_pages.c

Executable portable
  Build$:             flag(tests)
  CompiledObject:     best
  Path:               lib_test
  MainIs:             portable.ml
  Custom:             true
  Install:            false
  BuildDepends:       io-page.unix, mirage-types, oUnit
  CSources:           stub_get_addr.c

Test portable
  Command:            ./portable.native
  Run:                true
